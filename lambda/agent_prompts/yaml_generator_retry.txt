The previous YAML workflow generation failed. You MUST fix the issues and generate BOTH complete, valid workflows (CI and CD).

{validation_errors}

CRITICAL ISSUES TO FIX:
- Review each validation error carefully (if any listed above)
- Ensure BOTH CI and CD workflows are generated - THIS IS MANDATORY
- CI workflow must trigger on pull_request opened
- CD workflow must trigger on pull_request closed
- Ensure every job has `runs-on:` field (e.g., `runs-on: ubuntu-latest`) - THIS IS MANDATORY
- Ensure every job has `steps:` field with at least one step - THIS IS MANDATORY
- CI workflow should contain security scanning jobs (sast, sca, secrets-scan, iac-scan)
- CD workflow should contain infrastructure, build, and deploy jobs
- Ensure deploy jobs include actual deployment actions (not just credential configuration)
- Check YAML syntax and indentation for BOTH workflows
- Verify all required fields are present in BOTH workflows
- Make sure BOTH workflows are complete and functional

Previous YAML (first 500 chars for reference - DO NOT copy errors):
{previous_yaml}

{base_prompt}

CRITICAL: Generate BOTH COMPLETE and VALID workflows (CI and CD). The previous attempt was TRUNCATED or INCOMPLETE.

MANDATORY REQUIREMENTS FOR COMPLETENESS:
1. You MUST generate TWO separate workflows: CI and CD
2. CI Workflow MUST trigger on pull_request opened
3. CD Workflow MUST trigger on pull_request closed
4. BOTH workflows MUST be complete from start to finish - DO NOT truncate mid-generation
5. Every job in BOTH workflows must have both `runs-on:` and `steps:` fields
6. CI workflow must include all security scanning jobs (sast, sca, secrets-scan, iac-scan)
7. CD workflow must include infrastructure, build, and deploy jobs
8. The deploy job in CD workflow MUST include the actual ECS deployment command (e.g., `aws ecs update-service`)
9. All steps must be fully defined with complete commands in BOTH workflows
10. BOTH YAML code blocks must be complete (starts with ```yaml and ends with ```)
11. DO NOT stop mid-line, mid-command, or mid-block - generate the ENTIRE workflows
12. The deploy job in CD workflow must have ALL required steps:
    - Configure AWS credentials
    - Set ECS values (if needed)
    - Execute the actual deployment command (e.g., `aws ecs update-service --cluster ... --service ... --force-new-deployment`)
    - Any post-deployment verification steps

COMPLETENESS CHECKLIST FOR CI WORKFLOW:
- [ ] CI workflow starts with `name: CI Pipeline` and `on: pull_request` with `types: [opened]`
- [ ] All security scanning jobs (sast, sca, secrets-scan, iac-scan) are complete
- [ ] All jobs properly closed (proper YAML indentation)
- [ ] CI YAML code block properly closed with ```

COMPLETENESS CHECKLIST FOR CD WORKFLOW:
- [ ] CD workflow starts with `name: CD Pipeline` and `on: pull_request` with `types: [closed]`
- [ ] Infrastructure job is complete with all Terraform steps
- [ ] Build job is complete with Docker build and push
- [ ] Deploy job is complete with actual ECS update-service command
- [ ] All jobs properly closed (proper YAML indentation)
- [ ] CD YAML code block properly closed with ```

DO NOT repeat previous mistakes. Generate BOTH COMPLETE workflows this time.

